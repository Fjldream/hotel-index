<template>    <div class="login-con">        <header class="reg-header-con">            <img src="../../assets/reg/reg-back.jpg" alt="">        </header>        <main class="reg-main-con">            <div class="reg-container">                <van-form @submit="onSubmit" ref="regform">                    <div class="phone-con">                        <span class="iconfont icon-tel"></span>                        <van-field                                v-model="loginform.phone"                                name="phone"                                placeholder="小主，留个电话吧"                                clearable                                :rules="[{ required: true, message: '输入验证码' }]"                                @blur="checkPhoneNum"                                :error-message="errorMsg.phoneNUmError"                        />                    </div>                    <div class="phone-con phone-container code-con">                        <div class="reg-yuandian-con">                            <div class="reg-yuandian"></div>                        </div>                        <van-field                                v-model="loginform.recode"                                name="recode"                                placeholder="我们的秘密"                                :rules="[{ required: true, message: '输入验证码' }]"                        >                        </van-field>                        <button class="code-btn-con" type="button" v-show="!time" @click="handlecode">获取秘密</button>                        <button class="code-btn-con code-btn-con-g" type="button" v-show="time">{{time}}s</button>                    </div>                    <div class="reg-btn-con">                        <van-button round block type="info" native-type="submit"                                    class="reg-btn-requeire">                            欢迎回家                        </van-button>                    </div>                </van-form>            </div>        </main>    </div></template><script>     //import {apiLogin} from "../../http/api";    // import {SUCCESS} from "../../lib/base";     import Toast from "vant/lib/toast";    import 'vant/lib/toast/style';    export default {        name: "Login",        data() {            return {                loginform: {                    phone: '',                    recode: '',                },                errorMsg:{                  phoneNUmError:''                },                code: '1314',                time: 0,            }        },        watch: {        },        methods: {            onSubmit(value) {                let redirect = this.$route.query.redirect || 'Index';                let obj = Object.assign({},value,{'redirect':redirect});                if (this.loginform.recode === this.code) {                    this.$store.dispatch('handleLoginin',obj);                    // apiLogin(value).then(res=>{                    //     this.$store.commit('setToken',res.token);                    //     console.log(res);                    // }).catch(error=>{                    //     console.log(error);                    // })                }else{                    Toast('验证码错误');                }            },            handlecode() {                if (!this.time) {                    this.time = 60;                    let that = this;                    let t = setInterval(() => {                        if (that.time > 0) {                            that.time = that.time - 1;                        } else {                            clearInterval(t);                            this.time = 0;                        }                    }, 1000);                }            },            //js设置元素信息            setAttribute() {                let list = document.querySelectorAll('.van-field__control');                for (let i = 0; i < list.length; i++) {                    list[i].setAttribute('autocomplete', 'off');                }            },checkPhoneNum(){                console.log(this.loginform.phone.length);                if(!this.loginform.phone||this.loginform.phone.length===0){                    this.errorMsg.phoneNUmError='请输入手机号';                }else if(this.loginform.phone.length!==11){                    this.errorMsg.phoneNUmError='请输入11位手机号';                } else{                    this.errorMsg.phoneNUmError='';                }            }        }, mounted() {            this.setAttribute();        }    }</script><style src="../../style/login.css" scoped></style>